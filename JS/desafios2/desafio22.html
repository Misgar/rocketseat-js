<html>
<head>
    <meta charset="utf-8"/>

</head>
<body>
    <div id="app" style="display: inline;">
     
        <button class="botao">Clique aqui para criar um quadrado.</button>

    </div>

    <script>
    
        function getRandomColors(){
            var letters = "0123456789ABCDEF";
            var color = "#";

            for (var i = 0; i < 6; i++)
            {
                color += letters[Math.floor(Math.random() * 16)];
            }

            return color;
        }

        var btnElement = document.querySelector('button.botao');
        var idNum = 0;
        
        btnElement.onclick = function(){  

            var novaCor = getRandomColors();

            var containerElement = document.querySelector('#app');

            var divElement = document.createElement('div')

            var boxElements = document.querySelector('.box');

            divElement.setAttribute('class', 'box')

            divElement.setAttribute('onmouseover', 'mudaCor()')

            divElement.setAttribute('id', 'box' + idNum);

            containerElement.appendChild(divElement);

            divElement.style.width = 100;
            divElement.style.height = 100;
            divElement.style.margin = 15;
            divElement.style.backgroundColor = '#f00';
            idNum += 1;          
           
        }

        function mudaCor(){
                    
            var boxElements = document.querySelectorAll('div#box');
                    
            novaCor = getRandomColors();
            
            var el = document.getElementById('app');

            el.addEventListener('mouseover', function(e) {

                var boxId = document.getElementById(e.target.id);

                boxId.style.backgroundColor = novaCor;

            })
                    
                /*
                RESOLUÇÃO ANTERIOR, ONDE ALTERAVA-SE TODOS AS CLASSES AO MESMO TEMPO
                for (var i = 0; i <= boxElements.length; i++){

                    for (var arr of boxElements)
                        {
                            boxElements[i].style.backgroundColor = novaCor;
                        }

                    } 
                    
                */


                }
       
    </script>
</body>


</html>